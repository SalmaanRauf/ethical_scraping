# Workflow Integration Test (Steps 1-4)

This directory contains integration tests for the **implemented** components of the Agentic Research System workflow.

## Quick Start

1. **Setup the test environment:**
   ```bash
   python tests/test_config.py
   ```

2. **Run the workflow test:**
   ```bash
   python tests/run_workflow_test.py
   ```

## What the Test Does

The integration test validates the **implemented** workflow components:

1. **Extractors** - Tests SAM.gov, News, and SEC data extraction
2. **Scraper Agent** - Tests web scraping functionality  
3. **Data Consolidator** - Tests data processing and consolidation
4. **Analyst Agent** - Tests AI analysis of consolidated data

**Note:** Steps 5-8 (Validator, Archivist, Reporter, Complete Pipeline) are not yet implemented and are not tested.

## Test Modes

### Test Data Mode (Default)
- Uses simulated data when API keys are not configured
- Tests all implemented components without making real API calls
- Perfect for development and CI/CD

### Real API Mode
- Makes actual API calls when keys are configured
- Tests with real data from SAM.gov, news sources, and SEC
- Requires Google Search API key and CSE ID

## Configuration

### For Test Data Mode
No configuration needed - the test will automatically use simulated data.

### For Real API Mode
1. Get a Google Search API key from: https://developers.google.com/custom-search/v1/overview
2. Create a Google Custom Search Engine at: https://cse.google.com/
3. Update your `.env` file:
   ```
   GOOGLE_SEARCH_API_KEY=your_actual_api_key
   GOOGLE_CSE_ID=your_actual_cse_id
   ```

## Test Output

The test provides detailed output showing:
- ✅ Passed components
- ❌ Failed components with error details
- 📊 Data flow statistics (raw → consolidated → analyzed)
- ⏱️ Performance metrics
- 📄 Detailed JSON report

## Example Output

```
🚀 Starting Agentic Research System Integration Test (Steps 1-4)
========================================
📅 Test started at: 2024-01-15 10:30:00
🔧 Configuration: {'google_api_configured': True, 'google_cse_configured': True}

📊 Testing Extractors...
  🔍 Testing SAM.gov extractor...
    ✅ SAM.gov: 15 notices found
  📰 Testing News extractor...
    ✅ News: 25 articles found
  📄 Testing SEC extractor...
    ✅ SEC: 8 filings found

📋 Testing Data Consolidator...
  ✅ Consolidated items: 12

🧠 Testing Analyst Agent...
  ✅ Analyzed events: 5

🔄 Testing Complete Workflow (Steps 1-4)...
  📊 Step 1: Data Extraction
    ✅ Extracted 48 total items
  📋 Step 2: Data Consolidation
    ✅ Consolidated 12 items
  🧠 Step 3: Analysis
    ✅ Analyzed 5 events
  📊 Step 4: Results Summary
    📈 Raw data: 48 items
    🔄 Consolidated: 12 items
    🤖 Analyzed: 5 events

✅ Overall Status: PASSED
⏱️  Total Duration: 45.23 seconds
```

## Workflow Steps Tested

The test validates the complete data flow through the implemented components:

1. **📊 Extractors** → Raw data from SAM.gov, News, SEC
2. **🕷️ Scraper Agent** → Enhanced data extraction
3. **📋 Data Consolidator** → Process and filter relevant data
4. **🧠 Analyst Agent** → AI analysis and insights

## Future Steps (Not Yet Implemented)

The following components are planned but not yet implemented:
- **🔍 Validator** - Event validation and verification
- **💾 Archivist** - Data persistence and storage
- **📊 Reporter** - Report generation and export
- **🔄 Complete Pipeline** - Full end-to-end workflow

## Troubleshooting

### Common Issues

1. **Import Errors**
   - Make sure you're running from the project root directory
   - Check that all dependencies are installed: `pip install -r requirements.txt`

2. **API Key Errors**
   - The test will automatically fall back to test data mode
   - Configure API keys for full testing

3. **Database Errors**
   - The test will automatically create the database if it doesn't exist
   - Check file permissions for the `data/` directory

4. **Memory Issues**
   - The test includes memory management and will handle large datasets
   - If you encounter memory issues, reduce `MAX_RESULTS_PER_QUERY` in config

### Getting Help

If the test fails, check:
1. The detailed error output in the console
2. The JSON report file generated by the test
3. The component-specific error messages

## Test Files

- `test_workflow_integration.py` - Main integration test (Steps 1-4)
- `run_workflow_test.py` - Simple test runner
- `test_config.py` - Test environment setup
- `TEST_README.md` - This file

## Continuous Integration

The test is designed to work in CI/CD environments:
- No external dependencies required (uses test data)
- Comprehensive error reporting
- JSON output for automated analysis
- Exit codes for build systems

## Development Roadmap

Once Steps 1-4 are working correctly, the next development phases will be:
1. **Step 5: Validator** - Implement event validation
2. **Step 6: Archivist** - Implement data persistence
3. **Step 7: Reporter** - Implement report generation
4. **Step 8: Complete Pipeline** - Full end-to-end workflow 